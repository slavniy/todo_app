{% extends 'base.html' %}
{% block title %}
Тестирование
{% endblock %}
{% block content %}
<h1>Тестирование</h1>
{% for problem in problems %}  
<div class="card m-3 p-3">
    <h3 class="card-title">Вопрос {{loop.index}} <a href="{{url_for('problem_edit', problem_id=problem.id)}}"><img class="icon" src="{{url_for('static', filename='imgs/edit.png')}}" alt=""></a> <a href="{{url_for('problem_delete', problem_id=problem.id)}}"><img class="icon" src="{{url_for('static', filename='imgs/delete.png')}}" alt=""></a></h3>
    <p class="card-text">{{problem.question}}</p>
    {% if problem.img %}
    <img src="{{url_for('static', filename='imgs/' + problem.img)}}" class="mb-3 question-img">
    {% endif %}
    <form>
    <div class="row">
        <div class="col-md-8"><input type="hidden" value="{{problem.id}}" name="problem_id"></div>
        <div class="col-md-2"><input type="text" class="form-control" name="answer"></div>
        <div class="col-md-2"> <input type="button" class="btn btn-primary" onclick="check_answer(this)" value="Ответить"></div>
    </div>
    </form>
</div> 

{% endfor %}
<script>
    function check_answer(el) {
        $card = $(el).closest('.card');
        $form = $(el).closest('form');
        $(el).addClass('disabled')
        $.ajax({
            type: "POST",
            url: "/check_answer",
            data: $form.serialize(),
            success: function(response) {
                if (response == 'True')
                    {$card.css({"backgroundColor":"#b3ffb3"});}
                else 
                    {$card.css({"backgroundColor":"#ff9595"});}
            },
            error: function(error) {
                console.log(error);
            }
        });
    }
</script>
{% endblock %}